<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>GhostLink Dashboard</title>
    <style>
        body {
            background-color: #0f1115;
            color: #f1f5f9;
            font-family: 'Segoe UI', sans-serif;
            padding: 2rem;
        }

        h1 {
            color: #3b82f6;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1.5rem;
        }

        th, td {
            padding: 0.75rem;
            border: 1px solid #334155;
            text-align: left;
        }

        .human { background-color: #1a2e1f; }
        .bot { background-color: #3f1e1e; }
        .denied { background-color: #5a1e1e; }
    </style>
</head>
<body>
<nav style="position: absolute; top: 1rem; left: 1rem;">
    <select onchange="location = this.value;" style="padding: 0.5rem; font-size: 1rem;">
        <option selected disabled>Menu</option>
        <option value="/">Home</option>
        <option value="/dashboard">Dashboard</option>
    </select>
</nav>
    <h1>Visitor Log Dashboard</h1>
    <h2>Tracks below information about all visitors. Uses robots.txt to ban "good bots"
    and uses methods like (HELP) to detect and deny acces to other bots, scrapers, or crawlers
    (e.g. Python requests)</h2>

<button id="clear-log-button" style="padding: 0.5rem 1rem; background-color: #ef4444; color: white; border: none; border-radius: 5px; cursor: pointer;">
    Clear Log
</button>
<p id="clear-status" style="margin-top:10px; color:#94a3b8;"></p>

    <table>
        <thead>
            <tr>
                {% for col in columns %}
                    <th>{{ col }}</th>
                {% endfor %}
            </tr>
        </thead>
        <tbody>
            {% for row in rows %}
                <tr class="{{ row[3]|lower }}">
                    {% for cell in row %}
                        <td>{{ cell }}</td>
                    {% endfor %}
                </tr>
            {% endfor %}
        </tbody>
    </table>
<script>
document.getElementById('clear-log-button').addEventListener('click', function () {
    fetch('/clear')
        .then(response => {
            if (response.ok) {
                document.getElementById('clear-status').textContent = 'Log cleared successfully.';
                location.reload(); // refresh the page to update the log table
            } else {
                document.getElementById('clear-status').textContent = 'Failed to clear log.';
            }
        })
        .catch(() => {
            document.getElementById('clear-status').textContent = 'Error while clearing log.';
        });
});
</script>

</body>
</html>
